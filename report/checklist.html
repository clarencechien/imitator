<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—…è¡Œå¿…å‚™æ¸…å–®</title>
    
    <!-- PWA & iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ—…è¡Œæ¸…å–®">
    <meta name="theme-color" content="#3b82f6">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3135/3135768.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- PWA Manifest -->
    <link rel="manifest" id="manifest-placeholder">

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 10px; }
        
        /* é—œéµä¿®æ­£ï¼š
           1. -webkit-tap-highlight-color: transparent -> ç§»é™¤æ‰‹æ©Ÿé»æ“Šæ™‚çš„ç°è‰²é®ç½©
           2. user-select: none -> é˜²æ­¢é»æ“Šæ™‚æ–‡å­—è¢«é¸å– (åç™½)
           3. -webkit-touch-callout: none -> é˜²æ­¢é•·æŒ‰æ™‚å‡ºç¾é¸å–®
        */
        * {
            -webkit-tap-highlight-color: transparent;
        }

        .no-select {
            -webkit-user-select: none; /* Safari */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
            -webkit-touch-callout: none; /* iOS Safari */
        }

        /* Smooth check animation */
        .check-transition {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Safe area for iPhone notch */
        body {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>

    <script>
        // Dynamic Manifest for PWA
        const manifest = {
            "name": "æ—…è¡Œå¿…å‚™æ¸…å–®",
            "short_name": "æ—…è¡Œæ¸…å–®",
            "start_url": ".",
            "display": "standalone",
            "background_color": "#ffffff",
            "theme_color": "#3b82f6",
            "icons": [
                {
                    "src": "https://cdn-icons-png.flaticon.com/512/3135/3135768.png",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };
        const stringManifest = JSON.stringify(manifest);
        const blob = new Blob([stringManifest], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        document.querySelector('#manifest-placeholder').setAttribute('href', manifestURL);
    </script>
</head>
<body class="bg-gray-50 text-gray-800 h-screen overflow-hidden flex flex-col font-sans no-select">

    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const DEFAULT_ITEMS = [
            "é«®å¤¾&é«®ç®", "æ´—é¢ä¹³", "æ´—åˆ·åˆ·", "æ²æµ´ä¹³ã€æ´—é«®ç²¾ã€æ½¤é«®ä¹³",
            "ç‰™åˆ·ã€ç‰™è†ã€ç‰™ç·š", "ç¶­æŒå™¨", "éš±å½¢çœ¼é¡ã€çœ¼é¡&çœ¼é¡ç›’", "æ³¡æ¾¡éŒ ",
            "èº«é«”ä¹³æ¶²", "å‡¡å£«æ—", "è­·æ‰‹éœœ", "è‡‰éƒ¨ä¿é¤Šå“ã€é˜²æ›¬ã€åŒ–å¦å“",
            "é¢è†œ", "é¡å­", "æ¢³å­", "å¹é¢¨æ©Ÿ", "è¡›ç”Ÿç´™", "æ¿•ç´™å·¾", "å£ç½©",
            "è­·å¢Š&è¡›ç”Ÿæ£‰", "è¡£ç‰©ã€å…§è¡£è¤²ã€è¥ªå­ã€ç¡è¡£", "é«’è¡£å¡‘è† è¢‹",
            "é£¾å“", "é›¨å‚˜", "ä¸­è—¥", "å……é›»å™¨ã€è¡Œå‹•é›»æº", "ä¿å¥&è—¥å“",
            "ä¿æº«ç“¶", "æ³³è£", "è­·ç…§&å½±æœ¬", "å¤¾éˆè¢‹&ä¿é®®è†œ", "å‚™ç”¨æè¢‹",
            "æ¯›å·¾", "æ›¬è¡£å¤¾", "ç¶²çƒğŸ¾", "ç™¼ç†±è¡£", "å¸½å­/åœå·¾/æ‰‹å¥—", "é˜²éœé›»æ‰‹ç’°"
        ].map((text, index) => ({
            id: `default-${index}`,
            text: text,
            checked: false
        }));

        const App = () => {
            const [items, setItems] = useState(() => {
                const saved = localStorage.getItem('travel-checklist-v1');
                if (saved) {
                    try {
                        return JSON.parse(saved);
                    } catch (e) {
                        return DEFAULT_ITEMS;
                    }
                }
                return DEFAULT_ITEMS;
            });

            const [newItemText, setNewItemText] = useState("");
            const [showConfirmReset, setShowConfirmReset] = useState(false);
            const listEndRef = useRef(null);

            useEffect(() => {
                localStorage.setItem('travel-checklist-v1', JSON.stringify(items));
            }, [items]);

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            const toggleCheck = (id) => {
                setItems(prev => prev.map(item => 
                    item.id === id ? { ...item, checked: !item.checked } : item
                ));
            };

            const addNewItem = (e) => {
                e.preventDefault();
                if (!newItemText.trim()) return;

                const newItem = {
                    id: `user-${Date.now()}`,
                    text: newItemText.trim(),
                    checked: false
                };

                setItems(prev => [newItem, ...prev]);
                setNewItemText("");
            };

            const deleteItem = (id) => {
                // Remove confirm for faster deletion interaction, or keep if preferred
                if(window.confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹é …ç›®å—ï¼Ÿ")) {
                    setItems(prev => prev.filter(item => item.id !== id));
                }
            };

            const uncheckAll = () => {
                setItems(prev => prev.map(item => ({ ...item, checked: false })));
                setShowConfirmReset(false);
            };

            const total = items.length;
            const completed = items.filter(i => i.checked).length;
            const progress = total === 0 ? 0 : Math.round((completed / total) * 100);

            return (
                <div className="flex flex-col h-full max-w-md mx-auto w-full bg-white shadow-xl sm:rounded-xl overflow-hidden relative">
                    
                    <header className="bg-blue-600 text-white p-4 shadow-md z-10 shrink-0">
                        <div className="flex justify-between items-center mb-3">
                            <h1 className="text-xl font-bold flex items-center gap-2">
                                <i data-lucide="plane" className="w-6 h-6"></i>
                                æ—…è¡Œå¿…å‚™æ¸…å–®
                            </h1>
                            <button 
                                onClick={() => setShowConfirmReset(true)}
                                className="text-blue-100 hover:text-white p-1 rounded hover:bg-blue-500 transition active:scale-95"
                                title="å…¨éƒ¨é‡ç½®"
                            >
                                <i data-lucide="rotate-ccw" className="w-5 h-5"></i>
                            </button>
                        </div>

                        <div className="w-full bg-blue-800 rounded-full h-2.5 mb-1">
                            <div 
                                className="bg-white h-2.5 rounded-full transition-all duration-500 ease-out" 
                                style={{ width: `${progress}%` }}
                            ></div>
                        </div>
                        <div className="flex justify-between text-xs text-blue-100 mt-1">
                            <span>å·²å®Œæˆ {completed}/{total}</span>
                            <span>{progress}%</span>
                        </div>
                    </header>

                    <div className="p-3 bg-gray-50 border-b shrink-0">
                        <form onSubmit={addNewItem} className="flex gap-2 relative">
                            <input
                                type="text"
                                value={newItemText}
                                onChange={(e) => setNewItemText(e.target.value)}
                                placeholder="æ–°å¢ç‰©å“..."
                                className="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm text-base select-text" 
                                /* Keep input selectable */
                            />
                            <button 
                                type="submit"
                                className="absolute right-2 top-2 bottom-2 bg-blue-600 text-white px-4 rounded-md font-medium hover:bg-blue-700 active:scale-95 transition flex items-center justify-center"
                            >
                                <i data-lucide="plus" className="w-5 h-5"></i>
                            </button>
                        </form>
                    </div>

                    <div className="flex-1 overflow-y-auto overflow-x-hidden bg-white pb-24">
                        {items.length === 0 ? (
                            <div className="text-center text-gray-400 mt-20 flex flex-col items-center">
                                <i data-lucide="clipboard-list" className="w-16 h-16 mb-4 opacity-50"></i>
                                <p>ç›®å‰æ²’æœ‰é …ç›®</p>
                            </div>
                        ) : (
                            <ul className="divide-y divide-gray-100">
                                {items.map((item) => (
                                    <li 
                                        key={item.id} 
                                        /* Added select-none to prevent highlighting text on tap */
                                        className={`group flex items-center p-4 active:bg-blue-50 transition-colors cursor-pointer no-select ${item.checked ? 'bg-gray-50' : ''}`}
                                        onClick={() => toggleCheck(item.id)}
                                    >
                                        <div className={`
                                            flex-shrink-0 w-6 h-6 rounded border-2 mr-4 flex items-center justify-center transition-all duration-200
                                            ${item.checked ? 'bg-blue-500 border-blue-500' : 'border-gray-300'}
                                        `}>
                                            {item.checked && <i data-lucide="check" className="w-4 h-4 text-white"></i>}
                                        </div>
                                        
                                        <span className={`flex-1 text-lg transition-all duration-200 ${item.checked ? 'text-gray-400 line-through decoration-gray-300' : 'text-gray-800'}`}>
                                            {item.text}
                                        </span>

                                        <button 
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                deleteItem(item.id);
                                            }}
                                            className="p-2 text-gray-300 hover:text-red-500 transition-colors active:scale-95"
                                        >
                                            <i data-lucide="trash-2" className="w-5 h-5"></i>
                                        </button>
                                    </li>
                                ))}
                            </ul>
                        )}
                        <div ref={listEndRef} />
                    </div>

                    {showConfirmReset && (
                        <div className="absolute inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
                            <div className="bg-white rounded-xl shadow-2xl p-6 w-full max-w-xs animate-in fade-in zoom-in duration-200">
                                <h3 className="text-lg font-bold text-gray-900 mb-2">é‡ç½®æ‰€æœ‰å‹¾é¸ï¼Ÿ</h3>
                                <p className="text-gray-500 mb-6">é€™å°‡æœƒå–æ¶ˆæ‰€æœ‰é …ç›®çš„å‹¾é¸ç‹€æ…‹ã€‚</p>
                                <div className="flex gap-3">
                                    <button 
                                        onClick={() => setShowConfirmReset(false)}
                                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 active:bg-gray-100"
                                    >
                                        å–æ¶ˆ
                                    </button>
                                    <button 
                                        onClick={uncheckAll}
                                        className="flex-1 px-4 py-2 bg-blue-600 rounded-lg text-white font-medium hover:bg-blue-700 active:bg-blue-800"
                                    >
                                        ç¢ºå®š
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


