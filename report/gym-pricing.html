<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健身房教練課方案 | 視覺化分析圖表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- 
    Narrative Plan:
    1. Hook: Catchy title about making smart fitness investments.
    2. Section 1 (Package Overview): Bar chart to show price-per-session decreases.
    3. Section 2 (The "Upgrade" Secret): Responsive HTML/CSS flowchart.
    4. Section 3 (Cost Showdown): Grouped bar chart for a fixed comparison.
    5. Section 4 (NEW - Advanced Calculators):
        - Part A: Direct Purchase Calculator with detailed breakdown (e.g., 48 sessions vs 2 x 24 sessions).
        - Part B: Upgrade Path Calculator with corrected, valid starting packages (36 and 72 sessions).
    6. Section 5 (Recommendation): Donut chart to highlight the recommended package.

    Visualization Plan (NO SVG, NO MERMAID JS):
    All visualizations are implemented using Chart.js on Canvas or structured HTML with Tailwind CSS, ensuring NO SVG and NO MERMAID JS are used.
    
    Color Palette Selection: Energetic & Playful.
    
    Confirmation: NEITHER Mermaid JS NOR SVG were used in this output.
    -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8f9fa;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .flowchart-node {
            border: 2px solid;
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            text-align: center;
            background-color: white;
            width: 10rem;
            flex-shrink: 0;
        }
        .calculator-result-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
            gap: 0.5rem 1rem;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">聰明健身，精明消費</h1>
            <p class="text-xl md:text-2xl text-blue-600 mt-2">您的專屬教練課全攻略</p>
        </header>

        <main class="space-y-12">

            <section id="overview" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-2">第一步：了解價格結構</h2>
                <p class="text-gray-600 mb-6">教練課的核心原則是「買越多，單價越便宜」。這張圖表清楚顯示了不同方案的單價差異，幫助您快速掌握基本盤。</p>
                <div class="chart-container h-80 md:h-96">
                    <canvas id="pricePerSessionChart"></canvas>
                </div>
            </section>
            
            <section id="upgrade-flow" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-2">致勝關鍵：「升級」的秘密</h2>
                <p class="text-gray-600 mb-10">看不懂「可升級」是什麼意思？別擔心，這其實是為您省錢的彈性機制。透過這個流程圖，您可以了解如何從一個較小的方案無痛過渡到更優惠的方案。</p>
                <div class="flex flex-col md:flex-row justify-center items-center">
                    <div class="flowchart-node border-blue-500">
                        <h3 class="font-bold text-lg">先買 36 堂</h3>
                        <p class="text-sm text-gray-500">($1580/堂)</p>
                    </div>
                    <div class="flex flex-col items-center my-4 md:hidden">
                        <div class="w-px h-6 bg-gray-400"></div>
                        <span class="text-sm font-medium text-green-600 bg-green-50 px-2 py-1 rounded-full">未來決定續上</span>
                        <div class="w-px h-6 bg-gray-400"></div>
                    </div>
                    <div class="hidden md:flex flex-col items-center flex-grow px-4">
                        <span class="text-sm font-medium text-green-600 mb-1">未來決定續上</span>
                        <span class="text-3xl font-bold text-blue-500">+</span>
                    </div>
                    <div class="flowchart-node border-orange-500">
                        <h3 class="font-bold text-lg">補差額</h3>
                        <p class="text-sm text-gray-500">(不需重買)</p>
                    </div>
                    <div class="flex flex-col items-center my-4 md:hidden">
                        <div class="w-px h-6 bg-gray-400"></div>
                        <span class="text-sm font-medium text-gray-600 bg-gray-100 px-2 py-1 rounded-full">即可</span>
                        <div class="w-px h-6 bg-gray-400"></div>
                    </div>
                    <div class="hidden md:flex flex-col items-center flex-grow px-4">
                        <span class="text-sm font-medium text-gray-600 mb-1">即可</span>
                        <span class="text-3xl font-bold text-blue-500">=</span>
                    </div>
                    <div class="flowchart-node border-green-500 bg-green-50">
                        <h3 class="font-bold text-lg">升級至 72 堂</h3>
                        <p class="text-sm text-green-600">($1480/堂)</p>
                    </div>
                </div>
            </section>

            <section id="calculators" class="bg-gray-100 rounded-2xl shadow-inner p-6 md:p-8 space-y-10">
                <div>
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">費用試算 (一次性購買)</h2>
                    <p class="text-gray-600 mb-6 text-center">想知道買特定堂數能省多少嗎？請在下方輸入您預計購買的總堂數，立即計算差額！</p>
                    <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
                        <div class="flex flex-col md:flex-row gap-4 items-center">
                            <input type="number" id="session-input" placeholder="請輸入總堂數 (例如: 50)" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition">
                            <button id="calculate-btn" class="w-full md:w-auto bg-blue-600 text-white font-bold px-8 py-3 text-lg rounded-lg hover:bg-blue-700 transition shadow-md flex-shrink-0">計算</button>
                        </div>
                        <div id="calculator-result" class="mt-6 hidden">
                            <p class="text-gray-700 text-lg font-semibold text-center mb-4">目標 <strong id="result-sessions" class="text-blue-600"></strong> 堂課試算結果：</p>
                            <div class="space-y-4">
                                <div>
                                    <p class="font-semibold text-gray-800">智慧方案 (一次買足)</p>
                                    <p id="result-smart-detail" class="text-sm text-gray-500"></p>
                                    <p id="result-smart-cost" class="text-xl font-bold text-gray-800"></p>
                                </div>
                                 <div>
                                    <p class="font-semibold text-gray-800">基礎方案 (分次購買)</p>
                                    <p id="result-base-detail" class="text-sm text-gray-500"></p>
                                    <p id="result-base-cost" class="text-xl font-bold text-gray-800"></p>
                                </div>
                            </div>
                            <hr class="my-4">
                            <div class="text-center">
                                <p class="text-green-700 text-lg">預計可為您省下：</p>
                                <p id="result-savings" class="text-4xl font-bold text-green-600"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">升級方案試算</h2>
                    <p class="text-gray-600 mb-6 text-center">已經買了課，想知道升級要補多少錢嗎？這裡算給你看！</p>
                     <div class="bg-white p-6 rounded-lg shadow-md max-w-2xl mx-auto">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="initial-package" class="block text-sm font-medium text-gray-700 mb-1">我的初始方案 (限可升級方案)</label>
                                <select id="initial-package" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition">
                                    <option value="36" data-price="1580">36 堂 ($1580/堂)</option>
                                    <option value="72" data-price="1480">72 堂 ($1480/堂)</option>
                                </select>
                            </div>
                             <div>
                                <label for="target-sessions" class="block text-sm font-medium text-gray-700 mb-1">我想升級到</label>
                                <input type="number" id="target-sessions" placeholder="目標總堂數 (如: 96)" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-orange-500 focus:border-orange-500 transition">
                            </div>
                        </div>
                        <button id="calculate-upgrade-btn" class="w-full bg-orange-500 text-white font-bold px-8 py-3 text-lg rounded-lg hover:bg-orange-600 transition shadow-md mt-4">計算升級費用</button>
                        
                        <div id="upgrade-result" class="mt-6 hidden">
                             <div class="calculator-result-grid bg-gray-50 p-4 rounded-lg">
                                <span class="font-semibold text-gray-600">初始方案已付：</span>
                                <span id="upgrade-initial-cost" class="font-bold text-right"></span>
                                <span class="font-semibold text-gray-600">升級方案總價：</span>
                                <span id="upgrade-target-cost" class="font-bold text-right"></span>
                            </div>
                            <hr class="my-4 border-dashed">
                            <div class="text-center">
                                <p class="text-blue-700 text-lg">只需補繳差額：</p>
                                <p id="upgrade-top-up" class="text-4xl font-bold text-blue-600"></p>
                                <p id="upgrade-savings" class="mt-2 text-sm text-green-600 font-semibold"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="recommendation" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-2">總結：最佳起手式</h2>
                <p class="text-gray-600 mb-6">綜合考量彈性、價格與使用週期，教練的建議非常中肯。36堂課方案是平衡前期投入與長期優惠的最佳選擇。</p>
                <div class="flex flex-col md:flex-row items-center gap-8">
                    <div class="chart-container h-64 w-64 md:h-72 md:w-72 flex-shrink-0">
                         <canvas id="recommendationChart"></canvas>
                    </div>
                    <div class="text-left">
                        <h3 class="text-xl font-bold text-blue-600 mb-3">為什麼推薦「36堂可升級方案」？</h3>
                        <ul class="space-y-3">
                            <li class="flex items-start">
                                <span class="text-green-500 mr-3 mt-1">✔</span>
                                <div><strong class="font-semibold">保留優惠權利：</strong>鎖定未來用更低單價升級的資格，避免日後花冤枉錢。</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-3 mt-1">✔</span>
                                <div><strong class="font-semibold">降低初期門檻：</strong>無需一次投入大筆資金，讓您能更輕鬆地開始健身旅程。</div>
                            </li>
                             <li class="flex items-start">
                                <span class="text-green-500 mr-3 mt-1">✔</span>
                                 <div><strong class="font-semibold">使用週期理想：</strong>以正常頻率上課約可使用近一年，足夠培養穩定的運動習慣並看見成效。</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
    window.onload = function () {
        const vibrantPalette = {
            blue: 'rgba(0, 123, 255, 0.8)', blue_solid: 'rgb(0, 123, 255)',
            orange: 'rgba(255, 159, 64, 0.8)', orange_solid: 'rgb(255, 159, 64)',
            green: 'rgba(75, 192, 192, 0.8)', green_solid: 'rgb(75, 192, 192)',
            gray: 'rgba(201, 203, 207, 0.8)',
        };

        const f = new Intl.NumberFormat('en-US');

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) { return label.join(' '); }
            return label;
        };

        const commonChartOptions = {
            responsive: true, maintainAspectRatio: false,
            plugins: {
                legend: { labels: { font: { family: "'Noto Sans TC', sans-serif", size: 14 }}},
                tooltip: {
                    callbacks: { title: tooltipTitleCallback },
                    titleFont: { family: "'Noto Sans TC', sans-serif", size: 14 },
                    bodyFont: { family: "'Noto Sans TC', sans-serif", size: 12 }
                }
            },
            scales: {
                x: { ticks: { font: { family: "'Noto Sans TC', sans-serif", size: 12 }}, grid: { display: false }},
                y: { ticks: { font: { family: "'Noto Sans TC', sans-serif", size: 12 }}}
            }
        };

        new Chart(document.getElementById('pricePerSessionChart'), {
            type: 'bar',
            data: {
                labels: ['96 堂', '72 堂 / 48 堂', '36 堂 / 24 堂'],
                datasets: [{
                    label: '每堂課單價 (NT$)', data: [1380, 1480, 1580],
                    backgroundColor: [vibrantPalette.green, vibrantPalette.blue, vibrantPalette.orange],
                    borderColor: [vibrantPalette.green_solid, vibrantPalette.blue_solid, vibrantPalette.orange_solid],
                    borderWidth: 2, borderRadius: 5,
                }]
            },
            options: { ...commonChartOptions, indexAxis: 'y',
                plugins: { ...commonChartOptions.plugins, legend: { display: false }},
                scales: {
                    y: { ticks: { font: { family: "'Noto Sans TC', sans-serif", size: 14, weight: 'bold' }}, grid: { display: false }},
                    x: { ticks: { callback: (value) => '$' + value, font: { family: "'Noto Sans TC', sans-serif", size: 12 }}}
                }
            }
        });
        
        new Chart(document.getElementById('recommendationChart'), {
            type: 'doughnut',
            data: {
                labels: ['建議方案 (36堂)', '其他考量'],
                datasets: [{
                    label: '方案佔比', data: [80, 20],
                    backgroundColor: [vibrantPalette.blue, vibrantPalette.gray],
                    borderColor: ['#ffffff'], borderWidth: 4,
                }]
            },
            options: { responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom', labels: { font: { family: "'Noto Sans TC', sans-serif", size: 14 }}}, tooltip: { callbacks: { title: tooltipTitleCallback }}}
            }
        });

        function getPriceTier(sessions) {
            if (sessions >= 96) return 1380;
            if (sessions >= 48) return 1480;
            if (sessions >= 24) return 1580;
            return 1580; 
        }
        
        const SMALLEST_PACKAGE_SIZE = 24;
        const BASE_PRICE = 1580;

        const calculateBtn = document.getElementById('calculate-btn');
        const sessionInput = document.getElementById('session-input');
        calculateBtn.addEventListener('click', () => {
            const sessions = parseInt(sessionInput.value);
            if (!sessions || sessions <= 0) { alert('請輸入有效的堂數！'); return; }

            const smartPrice = getPriceTier(sessions);
            const smartCost = sessions * smartPrice;
            
            const numPackages = Math.floor(sessions / SMALLEST_PACKAGE_SIZE);
            const remainingSessions = sessions % SMALLEST_PACKAGE_SIZE;
            const baseCost = (numPackages * SMALLEST_PACKAGE_SIZE * BASE_PRICE) + (remainingSessions * BASE_PRICE);
            
            let baseDetailText = '';
            if (numPackages > 0 && remainingSessions > 0) {
                baseDetailText = `(${numPackages} × ${SMALLEST_PACKAGE_SIZE}堂) + ${remainingSessions}堂`;
            } else if (numPackages > 0 && remainingSessions === 0) {
                 baseDetailText = `${numPackages} × ${SMALLEST_PACKAGE_SIZE}堂`;
            } else {
                 baseDetailText = `${remainingSessions}堂`;
            }
            baseDetailText += ` × NT$ ${BASE_PRICE}/堂`;

            const savings = baseCost - smartCost;

            document.getElementById('result-sessions').textContent = sessions;
            document.getElementById('result-smart-detail').textContent = `${sessions} 堂 × NT$ ${smartPrice}/堂`;
            document.getElementById('result-smart-cost').textContent = `NT$ ${f.format(smartCost)}`;
            document.getElementById('result-base-detail').textContent = baseDetailText;
            document.getElementById('result-base-cost').textContent = `NT$ ${f.format(baseCost)}`;
            document.getElementById('result-savings').textContent = `NT$ ${f.format(savings)}`;
            document.getElementById('calculator-result').classList.remove('hidden');
        });

        const calculateUpgradeBtn = document.getElementById('calculate-upgrade-btn');
        calculateUpgradeBtn.addEventListener('click', () => {
            const initialPackageSelect = document.getElementById('initial-package');
            const selectedOption = initialPackageSelect.options[initialPackageSelect.selectedIndex];
            const initialSessions = parseInt(selectedOption.value);
            const initialPrice = parseInt(selectedOption.dataset.price);

            const targetSessions = parseInt(document.getElementById('target-sessions').value);
            
            if (!targetSessions || targetSessions <= initialSessions) {
                alert(`目標堂數必須大於初始方案的 ${initialSessions} 堂！`);
                return;
            }
            
            const targetPrice = getPriceTier(targetSessions);
            
            const initialCostPaid = initialSessions * initialPrice;
            const totalTargetCost = targetSessions * targetPrice;
            const upgradeTopUp = totalTargetCost - initialCostPaid;

            const remainingSessions = targetSessions - initialSessions;
            const costIfBoughtSeparately = remainingSessions * BASE_PRICE;
            const savingsVsSeparate = costIfBoughtSeparately - upgradeTopUp;

            document.getElementById('upgrade-initial-cost').innerHTML = `NT$ ${f.format(initialCostPaid)} <span class="text-xs text-gray-500">(${initialSessions}堂 × ${initialPrice})</span>`;
            document.getElementById('upgrade-target-cost').innerHTML = `NT$ ${f.format(totalTargetCost)} <span class="text-xs text-gray-500">(${targetSessions}堂 × ${targetPrice})</span>`;
            document.getElementById('upgrade-top-up').textContent = `NT$ ${f.format(upgradeTopUp)}`;
            
            if (savingsVsSeparate > 0) {
                 document.getElementById('upgrade-savings').textContent = `(相較於用原價加購 ${remainingSessions} 堂，可再省下 NT$ ${f.format(savingsVsSeparate)})`;
            } else {
                 document.getElementById('upgrade-savings').textContent = `(升級費用與原價加購相同)`;
            }
            
            document.getElementById('upgrade-result').classList.remove('hidden');
        });
    };
    </script>
</body>
</html>

