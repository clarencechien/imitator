<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPO 端點鎖定速查表 (Windows 風格)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Segoe UI', 'Inter', '微軟正黑體', 'Microsoft JhengHei', sans-serif;
            background-color: #f0f2f5; /* Windows-like light gray background */
            color: #1f1f1f; /* Dark text for readability */
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e1e1e1;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.12);
            transition: box-shadow 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 2px 6px rgba(0,0,0,0.08);
        }
        .gpo-path {
            background-color: #e1e1e1;
            color: #202020;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-family: 'Consolas', 'Courier New', monospace;
            word-break: break-all;
        }
        .copy-btn {
            background-color: #f0f2f5;
            color: #333;
            border: 1px solid #cccccc;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        .copy-btn:hover {
            background-color: #e1e1e1;
        }
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0;
            color: #333;
        }
        .step-number {
            background-color: #0078d4; /* Windows accent blue */
            color: #ffffff;
            border-radius: 9999px;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">

    <div class="max-w-5xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-2">GPO 端點鎖定速查表</h1>
            <p class="text-lg text-gray-600">將 Windows 筆電改造為單一用途 Kiosk 工作站</p>
        </header>

        <main>
            <!-- Phase 1: Preparation -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-lucide="folder-tree" class="w-6 h-6 mr-3 text-blue-600"></i>階段一：準備與規劃</h2>
                <ol class="space-y-4">
                    <li class="flex items-start">
                        <div class="step-number">1</div>
                        <div class="ml-4">
                            <h3 class="font-semibold text-gray-800">建立專屬 OU</h3>
                            <p class="text-gray-600">在 AD 中建立新的組織單位 (OU) (例如: `Kiosk_Workstations_OU`)，用於存放目標電腦與使用者帳戶。</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <div class="step-number">2</div>
                        <div class="ml-4">
                            <h3 class="font-semibold text-gray-800">建立專屬 GPO</h3>
                            <p class="text-gray-600">建立新 GPO (例如: `Kiosk Lockdown Policy`)，並將其連結至上述 OU。</p>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <div class="step-number">3</div>
                        <div class="ml-4">
                            <h3 class="font-semibold text-gray-800">盤點應用程式資訊</h3>
                            <p class="text-gray-600">取得 Workspace 應用程式的完整執行檔路徑及允許存取的內部網站 URL。</p>
                        </div>
                    </li>
                </ol>
            </div>

            <!-- Phase 2: Core Lockdown -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-lucide="shield-check" class="w-6 h-6 mr-3 text-blue-600"></i>階段二：核心應用程式鎖定</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">1. 設定 AppLocker (應用程式白名單)</h3>
                        <div class="pl-4 border-l-2 border-gray-300 space-y-2">
                            <p class="text-gray-700"><strong><span class="text-red-600 font-bold">關鍵步驟：</span></strong> 在「可執行檔規則」上按右鍵，選擇「建立預設規則」，允許系統核心檔案運行。</p>
                            <p class="text-gray-700">建立一條新的「允許」規則，指定 Workspace 應用程式的路徑或發行者。</p>
                            <p class="text-gray-700">將規則模式設為「強制執行」。</p>
                            <p class="flex items-center flex-wrap gap-2 text-gray-700">路徑: <code class="gpo-path">電腦設定 -> Windows 設定 -> 安全性設定 -> 應用程式控制原則 -> AppLocker</code> <button class="copy-btn" onclick="copyToClipboard(this, '電腦設定 -> Windows 設定 -> 安全性設定 -> 應用程式控制原則 -> AppLocker')"><i data-lucide="copy" class="w-4 h-4"></i><span class="copy-text">複製</span></button></p>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">2. 設定 Shell Launcher (替換使用者桌面)</h3>
                        <div class="pl-4 border-l-2 border-gray-300 space-y-2">
                            <p class="text-gray-700">啟用「自訂使用者介面」原則，並在介面檔案名稱中填入 Workspace 應用程式的完整路徑。</p>
                             <p class="flex items-center flex-wrap gap-2 text-gray-700">路徑: <code class="gpo-path">使用者設定 -> 系統管理範本 -> 系統 -> 自訂使用者介面</code> <button class="copy-btn" onclick="copyToClipboard(this, '使用者設定 -> 系統管理範本 -> 系統 -> 自訂使用者介面')"><i data-lucide="copy" class="w-4 h-4"></i><span class="copy-text">複製</span></button></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phase 3: System Restriction -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-lucide="ban" class="w-6 h-6 mr-3 text-blue-600"></i>階段三：系統功能與權限限縮</h2>
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-4">
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">停用系統管理工具</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>禁止存取控制台和 PC 設定</li>
                            <li>防止存取登錄編輯工具</li>
                            <li>防止存取命令提示字元</li>
                            <li>移除工作管理員</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">限制資料存取</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>拒絕所有卸除式存放裝置存取權</li>
                            <li>設定瀏覽器原則，僅允許存取指定的內部網站</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 4: Verification -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 flex items-center"><i data-lucide="list-checks" class="w-6 h-6 mr-3 text-blue-600"></i>階段四：部署與驗證</h2>
                <p class="text-gray-600 mb-4">將測試電腦/使用者移至目標 OU，執行 <code class="gpo-path">gpupdate /force</code> 後，驗證以下項目：</p>
                <div class="space-y-2">
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>登入後直接啟動 Workspace 應用程式</span></div>
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>無法看到桌面、工作列或開始功能表</span></div>
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>無法執行非白名單程式 (如 notepad.exe)</span></div>
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>無法開啟工作管理員、CMD 等工具</span></div>
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>瀏覽器只能存取指定的內部網站</span></div>
                    <div class="checklist-item"><input type="checkbox" class="h-5 w-5 bg-gray-200 border-gray-400 rounded text-blue-600 focus:ring-blue-500"><span>USB 隨身碟被成功阻擋</span></div>
                </div>
            </div>

        </main>
        
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p>此速查表為實施指南，請在正式環境部署前務必進行完整測試。</p>
        </footer>
    </div>

    <script>
        lucide.createIcons();

        function copyToClipboard(buttonElement, text) {
            if (!navigator.clipboard) {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-9999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                } catch (err) {
                    console.error('Fallback: 無法複製', err);
                }
                document.body.removeChild(textArea);
            } else {
                 navigator.clipboard.writeText(text).catch(err => {
                    console.error('無法複製文字: ', err);
                });
            }
            
            const copyTextElement = buttonElement.querySelector('.copy-text');
            const originalText = copyTextElement.innerText;
            const originalBg = buttonElement.style.backgroundColor;
            const originalBorder = buttonElement.style.borderColor;

            copyTextElement.innerText = '已複製!';
            buttonElement.style.backgroundColor = '#dff6dd';
            buttonElement.style.borderColor = '#a3d4a1';
            
            setTimeout(() => {
                copyTextElement.innerText = originalText;
                buttonElement.style.backgroundColor = originalBg;
                buttonElement.style.borderColor = originalBorder;
            }, 2000);
        }
    </script>
</body>
</html>

